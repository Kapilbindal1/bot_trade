const { averageRate, sellCoins } = require('../utils/average');

const btcTrades = [
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088143493',
      orderId: '7834995102',
      orderListId: '-1',
      price: '54851.78000000',
      qty: '0.00032000',
      quoteQty: '17.55256960',
      commission: '0.00000032',
      commissionAsset: 'BTC',
      time: '1633803017726',
      isBuyer: true,
      isMaker: false,
      isBestMatch: true
    },
    timestamp: 1633803017726,
    datetime: '2021-10-09T18:10:17.726Z',
    symbol: 'BTC/USDT',
    id: '1088143493',
    order: '7834995102',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'taker',
    price: 54851.78,
    amount: 0.00032,
    cost: 17.5525696,
    fee: { cost: 3.2e-7, currency: 'BTC' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088190746',
      orderId: '7835374449',
      orderListId: '-1',
      price: '54870.53000000',
      qty: '0.00026000',
      quoteQty: '14.26633780',
      commission: '0.01426634',
      commissionAsset: 'USDT',
      time: '1633805153167',
      isBuyer: false,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1633805153167,
    datetime: '2021-10-09T18:45:53.167Z',
    symbol: 'BTC/USDT',
    id: '1088190746',
    order: '7835374449',
    type: undefined,
    side: 'sell',
    takerOrMaker: 'maker',
    price: 54870.53,
    amount: 0.00026,
    cost: 14.2663378,
    fee: { cost: 0.01426634, currency: 'USDT' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088191068',
      orderId: '7835379162',
      orderListId: '-1',
      price: '54870.53000000',
      qty: '0.00026000',
      quoteQty: '14.26633780',
      commission: '0.01426634',
      commissionAsset: 'USDT',
      time: '1633805166648',
      isBuyer: false,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1633805166648,
    datetime: '2021-10-09T18:46:06.648Z',
    symbol: 'BTC/USDT',
    id: '1088191068',
    order: '7835379162',
    type: undefined,
    side: 'sell',
    takerOrMaker: 'maker',
    price: 54870.53,
    amount: 0.00026,
    cost: 14.2663378,
    fee: { cost: 0.01426634, currency: 'USDT' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088194477',
      orderId: '7835406291',
      orderListId: '-1',
      price: '54890.53000000',
      qty: '0.00026000',
      quoteQty: '14.27153780',
      commission: '0.01427154',
      commissionAsset: 'USDT',
      time: '1633805347265',
      isBuyer: false,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1633805347265,
    datetime: '2021-10-09T18:49:07.265Z',
    symbol: 'BTC/USDT',
    id: '1088194477',
    order: '7835406291',
    type: undefined,
    side: 'sell',
    takerOrMaker: 'maker',
    price: 54890.53,
    amount: 0.00026,
    cost: 14.2715378,
    fee: { cost: 0.01427154, currency: 'USDT' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088211617',
      orderId: '7835548238',
      orderListId: '-1',
      price: '54881.52000000',
      qty: '0.00032000',
      quoteQty: '17.56208640',
      commission: '0.00000032',
      commissionAsset: 'BTC',
      time: '1633806206231',
      isBuyer: true,
      isMaker: false,
      isBestMatch: true
    },
    timestamp: 1633806206231,
    datetime: '2021-10-09T19:03:26.231Z',
    symbol: 'BTC/USDT',
    id: '1088211617',
    order: '7835548238',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'taker',
    price: 54881.52,
    amount: 0.00032,
    cost: 17.5620864,
    fee: { cost: 3.2e-7, currency: 'BTC' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088213571',
      orderId: '7835561769',
      orderListId: '-1',
      price: '54950.53000000',
      qty: '0.00026000',
      quoteQty: '14.28713780',
      commission: '0.01428714',
      commissionAsset: 'USDT',
      time: '1633806311927',
      isBuyer: false,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1633806311927,
    datetime: '2021-10-09T19:05:11.927Z',
    symbol: 'BTC/USDT',
    id: '1088213571',
    order: '7835561769',
    type: undefined,
    side: 'sell',
    takerOrMaker: 'maker',
    price: 54950.53,
    amount: 0.00026,
    cost: 14.2871378,
    fee: { cost: 0.01428714, currency: 'USDT' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088213790',
      orderId: '7835566503',
      orderListId: '-1',
      price: '54955.25000000',
      qty: '0.00026000',
      quoteQty: '14.28836500',
      commission: '0.01428837',
      commissionAsset: 'USDT',
      time: '1633806323066',
      isBuyer: false,
      isMaker: false,
      isBestMatch: true
    },
    timestamp: 1633806323066,
    datetime: '2021-10-09T19:05:23.066Z',
    symbol: 'BTC/USDT',
    id: '1088213790',
    order: '7835566503',
    type: undefined,
    side: 'sell',
    takerOrMaker: 'taker',
    price: 54955.25,
    amount: 0.00026,
    cost: 14.288365,
    fee: { cost: 0.01428837, currency: 'USDT' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088222884',
      orderId: '7835656151',
      orderListId: '-1',
      price: '54840.53000000',
      qty: '0.00045000',
      quoteQty: '24.67823850',
      commission: '0.00000045',
      commissionAsset: 'BTC',
      time: '1633806957093',
      isBuyer: true,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1633806957093,
    datetime: '2021-10-09T19:15:57.093Z',
    symbol: 'BTC/USDT',
    id: '1088222884',
    order: '7835656151',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'maker',
    price: 54840.53,
    amount: 0.00045,
    cost: 24.6782385,
    fee: { cost: 4.5e-7, currency: 'BTC' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088223085',
      orderId: '7835660531',
      orderListId: '-1',
      price: '54838.32000000',
      qty: '0.00045000',
      quoteQty: '24.67724400',
      commission: '0.00000045',
      commissionAsset: 'BTC',
      time: '1633806971050',
      isBuyer: true,
      isMaker: false,
      isBestMatch: true
    },
    timestamp: 1633806971050,
    datetime: '2021-10-09T19:16:11.050Z',
    symbol: 'BTC/USDT',
    id: '1088223085',
    order: '7835660531',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'taker',
    price: 54838.32,
    amount: 0.00045,
    cost: 24.677244,
    fee: { cost: 4.5e-7, currency: 'BTC' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1088438796',
      orderId: '7835689608',
      orderListId: '-1',
      price: '54950.53000000',
      qty: '0.00026000',
      quoteQty: '14.28713780',
      commission: '0.01428714',
      commissionAsset: 'USDT',
      time: '1633817704059',
      isBuyer: false,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1633817704059,
    datetime: '2021-10-09T22:15:04.059Z',
    symbol: 'BTC/USDT',
    id: '1088438796',
    order: '7835689608',
    type: undefined,
    side: 'sell',
    takerOrMaker: 'maker',
    price: 54950.53,
    amount: 0.00026,
    cost: 14.2871378,
    fee: { cost: 0.01428714, currency: 'USDT' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1089136423',
      orderId: '7841723775',
      orderListId: '-1',
      price: '55471.99000000',
      qty: '0.00026000',
      quoteQty: '14.42271740',
      commission: '0.01442272',
      commissionAsset: 'USDT',
      time: '1633843409568',
      isBuyer: false,
      isMaker: false,
      isBestMatch: true
    },
    timestamp: 1633843409568,
    datetime: '2021-10-10T05:23:29.568Z',
    symbol: 'BTC/USDT',
    id: '1089136423',
    order: '7841723775',
    type: undefined,
    side: 'sell',
    takerOrMaker: 'taker',
    price: 55471.99,
    amount: 0.00026,
    cost: 14.4227174,
    fee: { cost: 0.01442272, currency: 'USDT' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1139518083',
      orderId: '8205529616',
      orderListId: '-1',
      price: '65500.00000000',
      qty: '0.00125000',
      quoteQty: '81.87500000',
      commission: '0.08187500',
      commissionAsset: 'USDT',
      time: '1636577437055',
      isBuyer: false,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1636577437055,
    datetime: '2021-11-10T20:50:37.055Z',
    symbol: 'BTC/USDT',
    id: '1139518083',
    order: '8205529616',
    type: undefined,
    side: 'sell',
    takerOrMaker: 'maker',
    price: 65500,
    amount: 0.00125,
    cost: 81.875,
    fee: { cost: 0.081875, currency: 'USDT' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1149713872',
      orderId: '8297070457',
      orderListId: '-1',
      price: '60253.08000000',
      qty: '0.00023000',
      quoteQty: '13.85820840',
      commission: '0.00000023',
      commissionAsset: 'BTC',
      time: '1637171353958',
      isBuyer: true,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1637171353958,
    datetime: '2021-11-17T17:49:13.958Z',
    symbol: 'BTC/USDT',
    id: '1149713872',
    order: '8297070457',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'maker',
    price: 60253.08,
    amount: 0.00023,
    cost: 13.8582084,
    fee: { cost: 2.3e-7, currency: 'BTC' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1159298286',
      orderId: '8375683942',
      orderListId: '-1',
      price: '56450.00000000',
      qty: '0.00035000',
      quoteQty: '19.75750000',
      commission: '0.00000035',
      commissionAsset: 'BTC',
      time: '1637720691121',
      isBuyer: true,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1637720691121,
    datetime: '2021-11-24T02:24:51.121Z',
    symbol: 'BTC/USDT',
    id: '1159298286',
    order: '8375683942',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'maker',
    price: 56450,
    amount: 0.00035,
    cost: 19.7575,
    fee: { cost: 3.5e-7, currency: 'BTC' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1164583773',
      orderId: '8417794035',
      orderListId: '-1',
      price: '54453.61000000',
      qty: '0.00036000',
      quoteQty: '19.60329960',
      commission: '0.00000036',
      commissionAsset: 'BTC',
      time: '1637987372258',
      isBuyer: true,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1637987372258,
    datetime: '2021-11-27T04:29:32.258Z',
    symbol: 'BTC/USDT',
    id: '1164583773',
    order: '8417794035',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'maker',
    price: 54453.61,
    amount: 0.00036,
    cost: 19.6032996,
    fee: { cost: 3.6e-7, currency: 'BTC' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1176967641',
      orderId: '8509239487',
      orderListId: '-1',
      price: '48136.10000000',
      qty: '0.00041000',
      quoteQty: '19.73580100',
      commission: '0.00000041',
      commissionAsset: 'BTC',
      time: '1638631594461',
      isBuyer: true,
      isMaker: false,
      isBestMatch: true
    },
    timestamp: 1638631594461,
    datetime: '2021-12-04T15:26:34.461Z',
    symbol: 'BTC/USDT',
    id: '1176967641',
    order: '8509239487',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'taker',
    price: 48136.1,
    amount: 0.00041,
    cost: 19.735801,
    fee: { cost: 4.1e-7, currency: 'BTC' }
  },
  {
    info: {
      symbol: 'BTCUSDT',
      id: '1189943952',
      orderId: '8634597910',
      orderListId: '-1',
      price: '47901.81000000',
      qty: '0.00031000',
      quoteQty: '14.84956110',
      commission: '0.00000031',
      commissionAsset: 'BTC',
      time: '1639535931331',
      isBuyer: true,
      isMaker: false,
      isBestMatch: true
    },
    timestamp: 1639535931331,
    datetime: '2021-12-15T02:38:51.331Z',
    symbol: 'BTC/USDT',
    id: '1189943952',
    order: '8634597910',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'taker',
    price: 47901.81,
    amount: 0.00031,
    cost: 14.8495611,
    fee: { cost: 3.1e-7, currency: 'BTC' }
  }
]

const adaTrades = [
  {
    info: {
      symbol: 'ADAUSDT',
      id: '311279679',
      orderId: '2573195144',
      orderListId: '-1',
      price: '2.04100000',
      qty: '15.40000000',
      quoteQty: '31.43140000',
      commission: '0.01540000',
      commissionAsset: 'ADA',
      time: '1636341560708',
      isBuyer: true,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1636341560708,
    datetime: '2021-11-08T03:19:20.708Z',
    symbol: 'ADA/USDT',
    id: '311279679',
    order: '2573195144',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'maker',
    price: 2.041,
    amount: 15.4,
    cost: 31.4314,
    fee: { cost: 0.0154, currency: 'ADA' }
  },
  {
    info: {
      symbol: 'ADAUSDT',
      id: '311279990',
      orderId: '2573192263',
      orderListId: '-1',
      price: '2.04000000',
      qty: '35.10000000',
      quoteQty: '71.60400000',
      commission: '0.03510000',
      commissionAsset: 'ADA',
      time: '1636341704589',
      isBuyer: true,
      isMaker: true,
      isBestMatch: true
    },
    timestamp: 1636341704589,
    datetime: '2021-11-08T03:21:44.589Z',
    symbol: 'ADA/USDT',
    id: '311279990',
    order: '2573192263',
    type: undefined,
    side: 'buy',
    takerOrMaker: 'maker',
    price: 2.04,
    amount: 35.1,
    cost: 71.604,
    fee: { cost: 0.0351, currency: 'ADA' }
  }
]

test('Calculating averate buying rate', (done) => {
  expect(averageRate(adaTrades)).toStrictEqual(2.0403049504950492)
  expect(averageRate(btcTrades)).toStrictEqual(56497.460925039886)
  done()
})

// test('Subtracting two numbers', (done) => {
//   expect(subtract(10, 10)).toStrictEqual(0)
//   expect(subtract(200, 100)).toStrictEqual(100)
//   done()
// })
